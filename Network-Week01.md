> CS 스터디 두 번째 책으로는 'IT 엔지니어를 위한 네트워크 입문'을 선택하였다. 네트워크에 대한 지식을 지주 필요로 하다보니 기초 CS 다음 순서로 바로 네트워크 관련 공부를 하기로 하였다. 3계층을 다루는 라우터 엔지니어와 4계층과 애플리케이션 계층을 주로 다루는 세션 장비 엔지니어의 시각차가 크다고 하고 심지어 같은 애플리케이션 게층을 다뤄도 네트워크 보안 엔지니어와 로드 밸런서 엔지니어의 시각이 다르다고 한다. 이 책은 다양한 관점에서 기술을 이해하는데 길잡이가 되어주는 책이다.

![](https://velog.velcdn.com/images/krylo71911/post/1c4f0475-482d-450f-8bd6-f3f73c948b8d/image.jpeg)

# 1장 네트워크 시작하기
## 1.1 네트워크 구성도 살펴보기
여기선 간단한 홈 네트워크 구성과 데이터 센터 네트워크 구성을 예제로 자주 사용되는 물리적인 연결 기술과 구성 요소를 살펴본다. 
네트워크는 크게 서비스를 받는 입장과 서비스를 제공하는 입장으로 나뉜다.

### 홈 네트워크
홈 네트워크를 구성하는데에는 모뎀, 공유기, 단말 간에 물리적 연결이 필요. 무선 연결에는 무선 랜 카드와 무선 신호를 보낼 수 있는 매체(공기)가 필요하고 유선 연결은 유선 랜 카드, 랜 케이블이 필요하다. 

### 데이터 센터 네트워크
안정적이고 빠른 대용량 서비스 제공을 목표로 구성. 다양한 이중화 기술을 사용해야 하고 높은 통신량을 수용할 수 있어야 한다. 그러므로 고속 이더넷 기술이 사용된다. 데이터 센터 구성은 3계층 구성이 일반적이었으나 스케일 아웃(Scale-Out) 기반의 애플리케이션과 서비스가 등장하면서 2계층 구성인 스파인-리프(Spine-Leaf) 구조로 데이터 센터 네트워크가 변화되었다.

(3계층 디자인, 2계층 디자인)

## 1.2 프로토콜
프로토콜이란? 규정이나 규약과 관련된 내용의 총칭. 네트워크 역시 통신할 때의 규약을 프로토콜이라고 한다. 최근에는 산재되어 있던 여러 프로토콜 기술이 이더넷-TCP/IP 기반 프로토콜들로 변경되고 있다. 
> - 물리적 측면 - 이더넷이 널리 쓰임.
> - 논리적 측면 - TCP/IP가 널리 쓰임.

한정된 자원으로 통신을 수행해야해서 최대한 적은 데이터를 이용해 효율적인 프로토콜을 정의하고 사용해야 했다. 과거에는 대부분의 프로토콜이 문자 기반이 아닌 2진수 비트 기반으로 만들어졌다. 애플리케이션 레벨이 되면서 비트 기반이 아닌 문자 기반 프로토콜이 많이 사용되는데 대표적으로 HTTP와 SMTP같은 프로토콜이 있다. 효율성은 비트 기반보다 떨어지나 다양한 확장이 가능해졌다. 

TCP/IP는 일반적으로 프로토콜이 아닌 프로토콜 스택(프로토콜 묶음)이라고 부른다. 여기엔 매우 다양한 애플리케이션 레이어 프로토콜들이 있다. TCP/IP 프로토콜 스택은 총 4개 부분으로 나뉜다. 물리 부분인 이더넷 외에 데이터가 목적지를 찾아가도록 해주는 네트워크 계층, 전송 계층과 애플리케이션 계층으로 구성된다. 

![](https://velog.velcdn.com/images/krylo71911/post/09b0cd86-6831-48df-aa64-5e060eeef731/image.png)

## 1.3 OSI 7계층과 TCP/IP
과거에는 통신용 규악이 표준화되어있지 않았고 각 벤더에서 별도로 개발했기에 호환되지 않는 시스템, 애플리케이션이 많았으며 통신도 불가능했다. 이를 하나의 규약으로 통합하려는 노력의 결과물이 현재의 OSI 7계층이다. 계층별로 표준화된 프로토콜 템플릿을 통해 네트워크 프로토콜을 전부 개발하는 대신 게층별로 프로토콜을 개발해 네트워크 구셩 요소들을 모듈화할 수 있다. 

> OSI 7계층은 다시 두 가지 계층으로 나눌 수 있다.
> - 1~4계층 : 데이터 플로 계층 / 하위 계층
> - 5~7계층 : 애플리케이션 계층 / 상위 계층

일반적으로 애플리케이션 개발자는 하향식 형식으로 네트워크를 바라보고 네트워크 엔지니어는 상향식 방식으로 네트워크를 인식한다.

TCP/IP는 이론보다 실용성에 중점을 둔 프로토콜이다. OSI 레퍼런스 모델은 7계층으로 이루어진 반면, TCP/IP 모델은 4계층으로 구분한다. OSI 7계층은 데이터 플로 계층과 애플리케이션 계층으로 구분할 수 있다. 이 두 계층의 구분은 데이터를 만드는 애플리케이션 부분과 이 데이터를 잘 전달하는데에만 집중하는 하부 계층으로 구분하는 것이 목적이었다. 

## 1.4 OSI 7계층별 이해하기
### 1계층(피지컬 계층)
1계층은 물리 계층으로 물리적 연결과 관련된 정보를 정의한다. 주요 장비로는 허브, 리피터, 케이블, 커넥터, 트랜시버, 탭이 있다. 1계층에서는 들어온 전기 신호를 그대로 잘 전달하는 것이 목적이기 때문에 전기 신호가 1계층 장비에 들어오면 이 전기 신호를 재생성하여 내보낸다. 주소의 개념이 없기 때문에 전기 신호가 들어온 포트를 제외하고 모든 포트에 같은 전기 신호를 전송한다. 
### 2계층(데이터 링크 계층)
데이터 링크 계층으로 전기 신호를 모아 우리가 알아볼 수 있는 데이터 형태로 처리한다. 주소 정보를 정의하고 정확한 주소로 통신이 되도록 하는 데 초점이 맞추어져 있다. 출발지와 도착지 주소를 확인하고 데이터 처리를 수행한다.
> 플로 컨트롤 (Flow Control)
무작정 데이터를 던지는 것이 아니라 받는 사람이 현재 데이터를 받을 수 있는지 확인하는 작업부터 하는 것.

2계층에서 동작하는 네트워크 구성 요소는 네트워크 인터페이스 카드(NIC)와 스위치로 이루어져 있다.
2계층의 가장 중요한 특징은 MAC 주소라는 주소 체계가 있다는 것이다. 
> - 네트워크 인터페이스 카드 동작 방식
1. 전기 신호를 데이터 형태로 만든다.
2. 목적지  MAC 주소와 출발지  MAC 주소를 확인한다.
3. 네트워크 인터페이스 카드의 MAC 주소를 확인한다.
4. 목적지 MAC 주소와 네트워크 인터페이스 카드가 갖고 있는 MAC 주소가 맞으면 데이터를 처리하고 다르면 데이터를 폐기한다.

### 3계층(네트워크 계층)
IP 주소와 같은 논리적인 주소가 정의된다. IP 주소는 사용자가 환경에 맞게 변경해 사용할 수 있고 네트워크 주소 부분과 호스트 주소 부분으로 나뉜다. 이 계층에서 동작하는 장비는 라우터이다. 라우터는 3계층에서 정의한 IP 주소를 이해할 수 있다. 라우터는 IP 주소를 사용해 최적의 경로를 찾아주고 해당 경로로 패킷을 전송하는 역할을 한다.

### 4계층(트랜스포트 계층)
4계층서부터는 역할이 달라지는데, 해당 데이터들이 정상적으로 잘 보내지도록 확인하는 역할을 한다. 데이터를 분할해 패킷에 실어보내는 중간에 패킷이 유실되거나 순서가 바뀌는 경우가 발생할 수 있다. 이를 바로잡아주는 역할을 4계층에서 담당한다. 
> 시퀀스 번호 : 패킷에 보내는 순서를 명시한 것.
> ACK 번호 : 받는 순서를 나타낸 것.
그 외에도 포트 번호를 사용해 상위 애플리케이션을 구분한다.

동작하는 장비로는 로드 밸런서와 방화벽이 있다. 부하를 분산하거나 보안 정책을 수립해 패킷을 통과, 차단하는 기능을 수행한다.

### 5계층(세션 계층)
양 끝단의 응용 프로세스가 연결을 성립하도록 도와주고 연결이 안정적으로 유지되도록 관리하고 작업 완료 후에 이 연결을 끊는 역할을 한다.

### 6계층(프레젠테이션 계층)
표현 방식이 다른 애플리케이션이나 시스템 간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 변환시키는 기능을 수행한다. 일종의 번역기나 변환기 역할을 수행하는 계층. MIME 인코딩이나 암호화, 압축, 코드 변환과 같은 동작이 이 계층에서 이루어진다.

### 7계층(애플리케이션 계층)
최상위 계층으로 애플리케이션 프로세스를 정의하고 애플리케이션 서비스를 수행한다. UI 부분이나 사용자 입, 출력 부분을 정의하는 것이 애플리케이션 계층의 역할이다. 대표적인 프로토콜로는 FTP, SMTP, HTTP, TELNET 등이 있다.

## 1.5 인캡슐레이션과 디캡슐레이션
데이터를 보내는 과정을 인캡슐레이션, 받는 과정을 디캡슐레이션이라고 부른다. 

![](https://velog.velcdn.com/images/krylo71911/post/84ae64d7-db9d-41c3-b18e-dcf445fbc064/image.png)

현대의 네트워크는 대부분 패킷이라는 작은 단위로 쪼개 보내는 패킷 기반 네트워크이다. 하나의 통신의 회선 전체를 점유하지 않고 동시에 여러 단말이 통신하도록 해준다. 
실제 데이터는 상위 계층 -> 하위 계층, 하위 계층 -> 상위 계층으로 전달되고 헤더 정보는 각 계층끼리 전달된다. 

> MSS & MTU(데이터 크기 조절)
네트워크에서 수용할 수 있는 크기를 역산정해 데이터가 4계층으로 내려올 때 적절한 크기로 유도할 떄의 값을 MSS라고 부른다. 네트워크에서 한 번에 보낼 수 있는 데이터 크기를 MTU라고 부른다. MTU값은 2계층 데이터의 값, MSS는 4계층에서 가질 수 있는 최대 데이터 값이다. 

![](https://velog.velcdn.com/images/krylo71911/post/ccdb22ab-5cfe-46db-a576-f326c2454015/image.png)
